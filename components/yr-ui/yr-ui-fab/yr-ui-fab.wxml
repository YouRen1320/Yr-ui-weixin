<wxs module="handler" src="./index.wxs"></wxs>
<view>
  <view class="yr-ui-fab__mask {{isShow?'yr-ui-fab__mask-show':''}}" style="{{parse.getStyle(maskBackground, zIndex)}}" wx:if="{{mask}}" catchtap="maskClick"></view>
  <view class="yr-ui-fab__btn-wrap {{position==='left'?'yr-ui-fab__wrap-left':'yr-ui-fab__wrap-right'}}" style="{{parse.getStyles(bottom, zIndex, position, distance)}}" data-disabled="{{isDrag?0:1}}" data-width="{{maxWidth}}" data-height="{{maxHeight}}" data-left="{{eLeft}}" data-top="{{eTop}}" bindtouchstart="{{handler.touchstart}}" catchtouchmove="{{handler.touchmove}}" prop="{{resetNum}}" change:prop="{{handler.fabreset}}">
    <view class="yr-ui-fab__btn-list {{isHidden?'yr-ui-fab__btn-hidden':''}} {{isShow?'yr-ui-fab__list-ani':''}} {{position==='left'?'yr-ui-fab__list-left':''}} {{position==='right'?'yr-ui-fab__list-right':''}}">
      <view class="yr-ui-fab__button-box {{position==='left'?'yr-ui-fab__button-left':'yr-ui-fab__button-right'}}" wx:for="{{fabs}}" wx:for-item="btn" wx:for-index="idx" wx:key="idx" catchtap="handleClick" data-index="{{idx}}">
        <text class="yr-ui-fab__btn-text" wx:if="{{btn[textKey]}}" style="font-size:{{btn.size || 32}}rpx;color:{{btn.color || '#fff'}};text-align:{{position==='left'?'left':'right'}}">{{btn[textKey]}}</text>
        <view class="yr-ui-fab__button {{!background && !btn.background?'yr-ui-fab__btn-color':''}}" style="width:{{width}}rpx;height:{{width}}rpx;background:{{btn.background || background}}">
          <yr-ui-icon name="{{btn[nameKey]}}" wx:if="{{btn[nameKey]}}" color="{{btn.abbrColor || '#fff'}}" size="{{btn.abbrSize || 64}}"></yr-ui-icon>
          <image src="{{btn[srcKey]}}" style="width:{{btn.width || 56}}rpx;height:{{btn.height || 56}}rpx;border-radius:{{btn.radius || 0}}rpx" wx:if="{{!btn[nameKey] && btn[srcKey]}}" mode="widthFix"></image>
          <text class="yr-ui-fab__btn-abbr" style="font-size:{{btn.abbrSize || 36}}rpx;line-height:{{btn.abbrSize || 36}}rpx;color:{{btn.abbrColor || '#fff'}}" wx:if="{{!btn[nameKey] && !btn[srcKey] && btn.abbr}}">{{btn.abbr}}</text>
        </view>
        <button class="yr-ui-fab__opentype-btn" open-type="{{btn.openType}}" app-parameter="{{btn.appParameter}}" lang="{{btn.lang}}" sessionFrom="{{btn.sessionFrom}}" sendMessageTitle="{{btn.sendMessageTitle}}" sendMessagePath="{{btn.sendMessagePath}}" sendMessageImg="{{btn.sendMessageImg}}" showMessageCard="{{btn.showMessageCard}}" bindcontact="bindcontact" bindopensetting="bindopensetting" bindlaunchapp="bindlaunchapp" wx:if="{{btn.openType}}"></button>
      </view>
    </view>
    <view class="yr-ui-fab__btn-main {{!background?'yr-ui-fab__btn-color':''}}" style="width:{{width}}rpx;height:{{width}}rpx;background:{{background}}" catchtap="handleClick" data-index="-1">
      <view class="yr-ui-fab__btn-inner {{isShow?'yr-ui-fab__btn-ani':''}}">
        <slot></slot>
        <yr-ui-icon wx:if="{{!custom}}" name="plus" color="{{color}}" size="{{80}}"></yr-ui-icon>
      </view>
      <button class="yr-ui-fab__opentype-btn" open-type="{{openType}}" app-parameter="{{appParameter}}" lang="{{lang}}" sessionFrom="{{sessionFrom}}" sendMessageTitle="{{sendMessageTitle}}" sendMessagePath="{{sendMessagePath}}" sendMessageImg="{{sendMessageImg}}" showMessageCard="{{showMessageCard}}" bindcontact="bindcontact" bindopensetting="bindopensetting" bindlaunchapp="bindlaunchapp" wx:if="{{openType}}"></button>
    </view>
  </view>
</view>

<wxs module="parse">
  module.exports = {
    getStyles: function (bottom, zIndex, position, distance) {
      var styles = "bottom:" + bottom + "rpx;z-index:" + zIndex + ";";
      if (position === 'left') {
        styles += "left:" + distance + "rpx;"
      } else {
        styles += "right:" + distance + "rpx;"
      }
      return styles;
    },
    getStyle: function (maskBackground, zIndex) {
      return "background:" + maskBackground + ";z-index:" + (parseInt(zIndex) - 10)
    }
  }
</wxs>